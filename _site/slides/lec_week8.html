<!DOCTYPE html>
<html lang="es"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.36">

  <meta name="author" content="Eloy Alvarado Narváez">
  <title>IND163C - Análisis de Negocios (Business Analytics) - Métodos supervisados: continuación</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Métodos supervisados: continuación</h1>
  <p class="subtitle">IND 163 - 2022/02</p>
  <p class="author">Eloy Alvarado Narváez</p>
  <p class="institute">Universidad Técnica Federico Santa María</p>
  <p class="date">14/10/22</p>
</section>

<section>
<section id="métodos-supervisados-continuación" class="title-slide slide level1 center">
<h1>Métodos supervisados: continuación</h1>

</section>
<section id="k-vecinos-cercanos" class="slide level2">
<h2>K-vecinos cercanos</h2>
<p>Como sabemos, un clasificador Bayesiano tiene la forma:</p>
<p><span class="math display">\[
\mathbb{P}(Y=j|X=x_o)
\]</span></p>
<p>que es simplemente una probabilidad condicional. Sin embargo, tomamos este clasificador como el idóneo no-obtenible, debido a que nos entrega el error de testeo. En la práctica, este clasificador no es alcanzable debido a que no sabemos la distribución condicional de <span class="math inline">\(Y\)</span> dado <span class="math inline">\(X\)</span>.</p>
</section>
<section id="k-vecinos-cercanos-continuación" class="slide level2">
<h2>K-vecinos cercanos: continuación</h2>
<p>Una metodología que intenta estimar la probabilidad condicional para luego asignar la clase <span class="math inline">\(k-\)</span>ésima a la observación que tenga la mayor probabilidad condicional es <strong>K-vecinos cercanos</strong> o <strong>KNN</strong> por sus siglas en inglés.</p>
<p>Dada un entero positivo <span class="math inline">\(K\)</span>, una observación de prueba <span class="math inline">\(x_0\)</span>, el clasificador <span class="math inline">\(KNN\)</span> primero identifica los <span class="math inline">\(K\)</span> puntos más cercanos a <span class="math inline">\(x_0\)</span> pertenecientes al conjunto de entrenamiento, representados por <span class="math inline">\(\mathcal{N}_0\)</span>. Luego estima la probabilidad condicional para la clase <span class="math inline">\(j-\)</span>ésima como una fracción de puntos en <span class="math inline">\(\mathcal{N}_0\)</span> cuyas respuestas son igual a la de <span class="math inline">\(j\)</span>, esto es:</p>
<p><span class="math display">\[
\mathbb{P}(Y=j|X=x_0)=\dfrac{1}{K}\sum_{i\in \mathcal{N}_0}I(y_i = j)
\]</span></p>
<p>Finalmente, <strong>KNN</strong> aplica la regla de Bayes y clasifica la observación de prueba/testeo <span class="math inline">\(x_0\)</span> a la clase con la mayor probabilidad</p>
</section>
<section id="rl-vs-lda-vs-qda-vs-knn" class="slide level2">
<h2>RL vs LDA vs QDA vs KNN</h2>
<p>Es natural preguntarse que técnica utilizar en distintas circunstancias, pues todas ellas tienen por finalidad clasificar observaciones. En lo que sigue se lista comentarios respecto a los nexos entre estas metodologías.</p>
<ul>
<li class="fragment"><p>Debido a que RL y LDA producen límites de decisión lineales, usualmente entregan resultados similares.</p></li>
<li class="fragment"><p>Debido a los supuestos distribucionales de LDA, si estos se cumplen, suele entregar mejores resultados que una regresión logística. De no cumplirse los supuestos, la regresión puede superar a LDA.</p></li>
<li class="fragment"><p>KNN al tener un enfoque enteramente no-paramétrico, esto es: no asume nada sobre la forma del límite de decisión. Si el límite de decisión es altamente no-lineal, KNN superará a la regresión logística y LDA. Sin embargo, no tendremos información de cuales predictores son importantes.</p></li>
</ul>
</section>
<section id="rl-vs-lda-vs-qda-vs-knn-continuación" class="slide level2">
<h2>RL vs LDA vs QDA vs KNN: continuación</h2>
<ul>
<li class="fragment"><p>QDA puede ser visto como un punto medio entre KNN y LDA/RL. Como el QDA asume un límite de decisión cuadrático, puede modelar más problemas que al asumir linealidad.</p></li>
<li class="fragment"><p>Si bien QDA no es tan flexible como KNN, puede entregar mejores resultados bajo un número limitado de observaciones de entrenamiento debido a que se hacen ciertos supuestos sobre la forma del límite de decisión.</p></li>
</ul>
</section></section>
<section>
<section id="ejemplos-para-un-mismo-conjunto-de-datos" class="title-slide slide level1 center">
<h1>Ejemplos para un mismo conjunto de datos</h1>
<p>Utilizaremos un conjunto de datos de rendimientos porcentuales de las acciones <strong>S&amp;P 500</strong> a lo largo de 1250 días, desde principios de 2001 hasta finales de 2005. Para cada día, se registraron los rendimientos porcentuals para cada uno de los 5 días hábiles previos (<code>lag1</code> a <code>lag5</code>). También se registró el volumen de acciones tranzadas en el día anterior (en billones) (variable <code>Volume</code>), el rendimiento porcentual del día en cuestión (variable <code>Today</code>) y la dirección, que representa si el mercado va hacia la alta o baja.</p>
</section>
<section id="análisis-exploratiorio" class="slide level2">
<h2>Análisis exploratiorio</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">names</span>(Smarket)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Year"      "Lag1"      "Lag2"      "Lag3"      "Lag4"      "Lag5"     
[7] "Volume"    "Today"     "Direction"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">dim</span>(Smarket)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1250    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">head</span>(Smarket)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Year   Lag1   Lag2   Lag3   Lag4   Lag5 Volume  Today Direction
1 2001  0.381 -0.192 -2.624 -1.055  5.010 1.1913  0.959        Up
2 2001  0.959  0.381 -0.192 -2.624 -1.055 1.2965  1.032        Up
3 2001  1.032  0.959  0.381 -0.192 -2.624 1.4112 -0.623      Down
4 2001 -0.623  1.032  0.959  0.381 -0.192 1.2760  0.614        Up
5 2001  0.614 -0.623  1.032  0.959  0.381 1.2057  0.213        Up
6 2001  0.213  0.614 -0.623  1.032  0.959 1.3491  1.392        Up</code></pre>
</div>
</div>
</section>
<section id="análisis-exploratorio-continuación" class="slide level2">
<h2>Análisis exploratorio: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">cor</span>(Smarket[,<span class="sc">-</span><span class="dv">9</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Year         Lag1         Lag2         Lag3         Lag4
Year   1.00000000  0.029699649  0.030596422  0.033194581  0.035688718
Lag1   0.02969965  1.000000000 -0.026294328 -0.010803402 -0.002985911
Lag2   0.03059642 -0.026294328  1.000000000 -0.025896670 -0.010853533
Lag3   0.03319458 -0.010803402 -0.025896670  1.000000000 -0.024051036
Lag4   0.03568872 -0.002985911 -0.010853533 -0.024051036  1.000000000
Lag5   0.02978799 -0.005674606 -0.003557949 -0.018808338 -0.027083641
Volume 0.53900647  0.040909908 -0.043383215 -0.041823686 -0.048414246
Today  0.03009523 -0.026155045 -0.010250033 -0.002447647 -0.006899527
               Lag5      Volume        Today
Year    0.029787995  0.53900647  0.030095229
Lag1   -0.005674606  0.04090991 -0.026155045
Lag2   -0.003557949 -0.04338321 -0.010250033
Lag3   -0.018808338 -0.04182369 -0.002447647
Lag4   -0.027083641 -0.04841425 -0.006899527
Lag5    1.000000000 -0.02200231 -0.034860083
Volume -0.022002315  1.00000000  0.014591823
Today  -0.034860083  0.01459182  1.000000000</code></pre>
</div>
</div>
</section>
<section id="análisis-exploratorio-continuación-1" class="slide level2">
<h2>Análisis exploratorio: continuación</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">plot_correlation</span>(Smarket[,<span class="sc">-</span><span class="dv">9</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lec_week8_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="análisis-exploratorio-continuación-2" class="slide level2">
<h2>Análisis exploratorio: continuación</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">attach</span>(Smarket)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">ggplot</span>(Smarket) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Smarket), <span class="at">y =</span> Volume) <span class="sc">+</span><span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="st">"circle"</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">colour =</span> <span class="st">"#4682B4"</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lec_week8_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="regresión-logística" class="slide level2">
<h2>Regresión logística</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>glm.fit<span class="ot">=</span><span class="fu">glm</span>(Direction<span class="sc">~</span>Lag1<span class="sc">+</span>Lag2<span class="sc">+</span>Lag3<span class="sc">+</span>Lag4<span class="sc">+</span>Lag5<span class="sc">+</span>Volume,<span class="at">data =</span> Smarket , <span class="at">family =</span> binomial )</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">summary</span>(glm.fit)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + 
    Volume, family = binomial, data = Smarket)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.446  -1.203   1.065   1.145   1.326  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -0.126000   0.240736  -0.523    0.601
Lag1        -0.073074   0.050167  -1.457    0.145
Lag2        -0.042301   0.050086  -0.845    0.398
Lag3         0.011085   0.049939   0.222    0.824
Lag4         0.009359   0.049974   0.187    0.851
Lag5         0.010313   0.049511   0.208    0.835
Volume       0.135441   0.158360   0.855    0.392

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1731.2  on 1249  degrees of freedom
Residual deviance: 1727.6  on 1243  degrees of freedom
AIC: 1741.6

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
</section>
<section id="regresión-logística-continuación" class="slide level2">
<h2>Regresión logística: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>glm.probs<span class="ot">=</span><span class="fu">predict</span>(glm.fit,<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>glm.probs[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
0.5070841 0.4814679 0.4811388 0.5152224 0.5107812 0.5069565 0.4926509 0.5092292 
        9        10 
0.5176135 0.4888378 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">contrasts</span>(Direction)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Up
Down  0
Up    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>glm.pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"Down"</span>,<span class="dv">1250</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>glm.pred[glm.probs<span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Up"</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="fu">table</span>(glm.pred,Direction)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Direction
glm.pred Down  Up
    Down  145 141
    Up    457 507</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>(<span class="dv">507</span><span class="sc">+</span><span class="dv">145</span>)<span class="sc">/</span><span class="dv">1250</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">mean</span>(glm.pred<span class="sc">==</span>Direction)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5216</code></pre>
</div>
</div>
</section>
<section id="regresión-logística-continuación-1" class="slide level2">
<h2>Regresión logística: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(glm.probs <span class="sc">&gt;=</span> <span class="fl">0.5</span>, Smarket<span class="sc">$</span>Direction <span class="sc">==</span> <span class="st">"Up"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

       
        FALSE TRUE
  FALSE   145  141
  TRUE    457  507
                                          
               Accuracy : 0.5216          
                 95% CI : (0.4935, 0.5496)
    No Information Rate : 0.5184          
    P-Value [Acc &gt; NIR] : 0.4216          
                                          
                  Kappa : 0.0237          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.2409          
            Specificity : 0.7824          
         Pos Pred Value : 0.5070          
         Neg Pred Value : 0.5259          
             Prevalence : 0.4816          
         Detection Rate : 0.1160          
   Detection Prevalence : 0.2288          
      Balanced Accuracy : 0.5116          
                                          
       'Positive' Class : FALSE           
                                          </code></pre>
</div>
</div>
</section>
<section id="regresión-logística-continuación-2" class="slide level2">
<h2>Regresión logística: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>train<span class="ot">=</span>(Year <span class="sc">&lt;</span><span class="dv">2005</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>Smarket<span class="fl">.2005</span><span class="ot">=</span>Smarket[<span class="sc">!</span>train,]</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="fu">dim</span>(Smarket<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 252   9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>Direction<span class="fl">.2005</span><span class="ot">=</span>Direction[<span class="sc">!</span>train]</span>
<span id="cb27-2"><a href="#cb27-2"></a>glm.fit<span class="ot">=</span><span class="fu">glm</span>(Direction<span class="sc">~</span>Lag1<span class="sc">+</span>Lag2<span class="sc">+</span>Lag3<span class="sc">+</span>Lag4<span class="sc">+</span>Lag5<span class="sc">+</span>Volume,<span class="at">data =</span> Smarket, <span class="at">family =</span> binomial, <span class="at">subset =</span> train)</span>
<span id="cb27-3"><a href="#cb27-3"></a>glm.probs<span class="ot">=</span><span class="fu">predict</span>(glm.fit,Smarket<span class="fl">.2005</span>,<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a>glm.pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"Down"</span>,<span class="dv">252</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>glm.pred[glm.probs <span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Up"</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="fu">table</span>(glm.pred, Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Direction.2005
glm.pred Down Up
    Down   77 97
    Up     34 44</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">mean</span>(glm.pred<span class="sc">==</span>Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4801587</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">mean</span>(glm.pred<span class="sc">!=</span>Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5198413</code></pre>
</div>
</div>
</section>
<section id="regresión-logística-continuación-3" class="slide level2">
<h2>Regresión logística: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(glm.probs <span class="sc">&gt;=</span> <span class="fl">0.5</span>, Smarket<span class="fl">.2005</span><span class="sc">$</span>Direction <span class="sc">==</span> <span class="st">"Up"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

       
        FALSE TRUE
  FALSE    77   97
  TRUE     34   44
                                         
               Accuracy : 0.4802         
                 95% CI : (0.417, 0.5437)
    No Information Rate : 0.5595         
    P-Value [Acc &gt; NIR] : 0.9952         
                                         
                  Kappa : 0.0054         
                                         
 Mcnemar's Test P-Value : 6.062e-08      
                                         
            Sensitivity : 0.6937         
            Specificity : 0.3121         
         Pos Pred Value : 0.4425         
         Neg Pred Value : 0.5641         
             Prevalence : 0.4405         
         Detection Rate : 0.3056         
   Detection Prevalence : 0.6905         
      Balanced Accuracy : 0.5029         
                                         
       'Positive' Class : FALSE          
                                         </code></pre>
</div>
</div>
</section>
<section id="regresión-logística-continuación-4" class="slide level2">
<h2>Regresión logística: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>glm.fit<span class="ot">=</span><span class="fu">glm</span>(Direction<span class="sc">~</span>Lag1<span class="sc">+</span>Lag2,<span class="at">data=</span>Smarket,<span class="at">family=</span>binomial,<span class="at">subset=</span>train)</span>
<span id="cb35-2"><a href="#cb35-2"></a>glm.probs<span class="ot">=</span><span class="fu">predict</span>(glm.fit,Smarket<span class="fl">.2005</span>,<span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a>glm.pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"Down"</span>,<span class="dv">252</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a>glm.pred[glm.probs <span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Up"</span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="fu">table</span>(glm.pred,Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Direction.2005
glm.pred Down  Up
    Down   35  35
    Up     76 106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">mean</span>(glm.pred<span class="sc">==</span>Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5595238</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="dv">106</span><span class="sc">/</span>(<span class="dv">106</span><span class="sc">+</span><span class="dv">76</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5824176</code></pre>
</div>
</div>
</section>
<section id="regresión-logística-continuación-5" class="slide level2">
<h2>Regresión logística: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(glm.probs <span class="sc">&gt;=</span> <span class="fl">0.5</span>, Smarket<span class="fl">.2005</span><span class="sc">$</span>Direction <span class="sc">==</span> <span class="st">"Up"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

       
        FALSE TRUE
  FALSE    35   35
  TRUE     76  106
                                          
               Accuracy : 0.5595          
                 95% CI : (0.4959, 0.6218)
    No Information Rate : 0.5595          
    P-Value [Acc &gt; NIR] : 0.5262856       
                                          
                  Kappa : 0.0698          
                                          
 Mcnemar's Test P-Value : 0.0001467       
                                          
            Sensitivity : 0.3153          
            Specificity : 0.7518          
         Pos Pred Value : 0.5000          
         Neg Pred Value : 0.5824          
             Prevalence : 0.4405          
         Detection Rate : 0.1389          
   Detection Prevalence : 0.2778          
      Balanced Accuracy : 0.5335          
                                          
       'Positive' Class : FALSE           
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">predict</span>(glm.fit,<span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Lag1=</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">1.5</span>),<span class="at">Lag2=</span><span class="fu">c</span>(<span class="fl">1.1</span>,<span class="sc">-</span><span class="fl">0.8</span>)), <span class="at">type=</span><span class="st">"response"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2 
0.4791462 0.4960939 </code></pre>
</div>
</div>
</section>
<section id="análisis-discriminante-lineal" class="slide level2">
<h2>Análisis discriminante lineal</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb45-2"><a href="#cb45-2"></a>lda.fit<span class="ot">=</span><span class="fu">lda</span>(Direction<span class="sc">~</span>Lag1<span class="sc">+</span>Lag2,<span class="at">data=</span>Smarket,<span class="at">subset=</span>train)</span>
<span id="cb45-3"><a href="#cb45-3"></a>lda.fit</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(Direction ~ Lag1 + Lag2, data = Smarket, subset = train)

Prior probabilities of groups:
    Down       Up 
0.491984 0.508016 

Group means:
            Lag1        Lag2
Down  0.04279022  0.03389409
Up   -0.03954635 -0.03132544

Coefficients of linear discriminants:
            LD1
Lag1 -0.6420190
Lag2 -0.5135293</code></pre>
</div>
</div>
</section>
<section id="análisis-discriminante-lineal-continuación" class="slide level2">
<h2>Análisis discriminante lineal: continuación</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">plot</span>(lda.fit)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lec_week8_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="análisis-discriminante-lineal-continuación-1" class="slide level2">
<h2>Análisis discriminante lineal: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>lda.pred<span class="ot">=</span><span class="fu">predict</span>(lda.fit,Smarket<span class="fl">.2005</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="fu">names</span>(lda.pred)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "class"     "posterior" "x"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>lda.class<span class="ot">=</span>lda.pred<span class="sc">$</span>class</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="fu">table</span>(lda.class,Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Direction.2005
lda.class Down  Up
     Down   35  35
     Up     76 106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">mean</span>(lda.class<span class="sc">==</span>Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5595238</code></pre>
</div>
</div>
</section>
<section id="análisis-discriminante-lineal-continuación-2" class="slide level2">
<h2>Análisis discriminante lineal: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(lda.class,Direction<span class="fl">.2005</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

         Direction.2005
lda.class Down  Up
     Down   35  35
     Up     76 106
                                          
               Accuracy : 0.5595          
                 95% CI : (0.4959, 0.6218)
    No Information Rate : 0.5595          
    P-Value [Acc &gt; NIR] : 0.5262856       
                                          
                  Kappa : 0.0698          
                                          
 Mcnemar's Test P-Value : 0.0001467       
                                          
            Sensitivity : 0.3153          
            Specificity : 0.7518          
         Pos Pred Value : 0.5000          
         Neg Pred Value : 0.5824          
             Prevalence : 0.4405          
         Detection Rate : 0.1389          
   Detection Prevalence : 0.2778          
      Balanced Accuracy : 0.5335          
                                          
       'Positive' Class : Down            
                                          </code></pre>
</div>
</div>
</section>
<section id="análisis-discriminante-lineal-continuación-3" class="slide level2">
<h2>Análisis discriminante lineal: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Aplicando un umbral del 50%</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="fu">sum</span>(lda.pred<span class="sc">$</span>posterior[,<span class="dv">1</span>] <span class="sc">&gt;=</span>.<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 70</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">sum</span>(lda.pred<span class="sc">$</span>posterior[,<span class="dv">1</span>] <span class="sc">&lt;</span>.<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Primeros 20 datos</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>lda.pred<span class="sc">$</span>posterior[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      999      1000      1001      1002      1003      1004      1005      1006 
0.4901792 0.4792185 0.4668185 0.4740011 0.4927877 0.4938562 0.4951016 0.4872861 
     1007      1008      1009      1010      1011      1012      1013      1014 
0.4907013 0.4844026 0.4906963 0.5119988 0.4895152 0.4706761 0.4744593 0.4799583 
     1015      1016      1017      1018 
0.4935775 0.5030894 0.4978806 0.4886331 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>lda.class[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Up   Up   Up   Up   Up   Up   Up   Up   Up   Up   Up   Down Up   Up   Up  
[16] Up   Up   Down Up   Up  
Levels: Down Up</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># Aplicando un umbral del 90%</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="fu">sum</span>(lda.pred<span class="sc">$</span>posterior[,<span class="dv">1</span>] <span class="sc">&gt;</span>.<span class="dv">9</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="análisis-discriminante-cuadrático" class="slide level2">
<h2>Análisis discriminante cuadrático</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>qda.fit<span class="ot">=</span><span class="fu">qda</span>(Direction<span class="sc">~</span>Lag1<span class="sc">+</span>Lag2,<span class="at">data=</span>Smarket,<span class="at">subset=</span>train)</span>
<span id="cb66-2"><a href="#cb66-2"></a>qda.fit</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
qda(Direction ~ Lag1 + Lag2, data = Smarket, subset = train)

Prior probabilities of groups:
    Down       Up 
0.491984 0.508016 

Group means:
            Lag1        Lag2
Down  0.04279022  0.03389409
Up   -0.03954635 -0.03132544</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>qda.class<span class="ot">=</span><span class="fu">predict</span>(qda.fit,Smarket<span class="fl">.2005</span>)<span class="sc">$</span>class</span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="fu">table</span>(qda.class,Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Direction.2005
qda.class Down  Up
     Down   30  20
     Up     81 121</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">mean</span>(qda.class<span class="sc">==</span>Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5992063</code></pre>
</div>
</div>
</section>
<section id="análisis-discriminante-cuadrático-continuación" class="slide level2">
<h2>Análisis discriminante cuadrático: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(qda.class,Direction<span class="fl">.2005</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

         Direction.2005
qda.class Down  Up
     Down   30  20
     Up     81 121
                                          
               Accuracy : 0.5992          
                 95% CI : (0.5358, 0.6602)
    No Information Rate : 0.5595          
    P-Value [Acc &gt; NIR] : 0.1138          
                                          
                  Kappa : 0.1364          
                                          
 Mcnemar's Test P-Value : 2.369e-09       
                                          
            Sensitivity : 0.2703          
            Specificity : 0.8582          
         Pos Pred Value : 0.6000          
         Neg Pred Value : 0.5990          
             Prevalence : 0.4405          
         Detection Rate : 0.1190          
   Detection Prevalence : 0.1984          
      Balanced Accuracy : 0.5642          
                                          
       'Positive' Class : Down            
                                          </code></pre>
</div>
</div>
</section>
<section id="k-vecinos-cercanos-1" class="slide level2">
<h2>K-vecinos cercanos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">library</span>(class)</span>
<span id="cb74-2"><a href="#cb74-2"></a>train.X<span class="ot">=</span><span class="fu">cbind</span>(Lag1,Lag2)[train,]</span>
<span id="cb74-3"><a href="#cb74-3"></a>test.X<span class="ot">=</span><span class="fu">cbind</span>(Lag1,Lag2)[<span class="sc">!</span>train,]</span>
<span id="cb74-4"><a href="#cb74-4"></a>train.Direction<span class="ot">=</span>Direction[train]</span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="fu">head</span>(train.X)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Lag1   Lag2
[1,]  0.381 -0.192
[2,]  0.959  0.381
[3,]  1.032  0.959
[4,] -0.623  1.032
[5,]  0.614 -0.623
[6,]  0.213  0.614</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>knn.pred<span class="ot">=</span><span class="fu">knn</span>(train.X,test.X,train.Direction,<span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="fu">table</span>(knn.pred,Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Direction.2005
knn.pred Down Up
    Down   43 58
    Up     68 83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>(<span class="dv">83</span><span class="sc">+</span><span class="dv">43</span>)<span class="sc">/</span><span class="dv">252</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
</div>
</section>
<section id="k-vecinos-cercanos-continuación-1" class="slide level2">
<h2>K-vecinos cercanos: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(knn.pred,Direction<span class="fl">.2005</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

        Direction.2005
knn.pred Down Up
    Down   43 58
    Up     68 83
                                          
               Accuracy : 0.5             
                 95% CI : (0.4366, 0.5634)
    No Information Rate : 0.5595          
    P-Value [Acc &gt; NIR] : 0.9751          
                                          
                  Kappa : -0.0242         
                                          
 Mcnemar's Test P-Value : 0.4227          
                                          
            Sensitivity : 0.3874          
            Specificity : 0.5887          
         Pos Pred Value : 0.4257          
         Neg Pred Value : 0.5497          
             Prevalence : 0.4405          
         Detection Rate : 0.1706          
   Detection Prevalence : 0.4008          
      Balanced Accuracy : 0.4880          
                                          
       'Positive' Class : Down            
                                          </code></pre>
</div>
</div>
</section>
<section id="k-vecinos-cercanos-continuación-2" class="slide level2">
<h2>K-vecinos cercanos: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>knn.pred<span class="ot">=</span><span class="fu">knn</span>(train.X,test.X,train.Direction,<span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="fu">table</span>(knn.pred,Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Direction.2005
knn.pred Down Up
    Down   48 55
    Up     63 86</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">mean</span>(knn.pred<span class="sc">==</span>Direction<span class="fl">.2005</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.531746</code></pre>
</div>
</div>
</section>
<section id="k-vecinos-cercanos-continuación-3" class="slide level2">
<h2>K-vecinos cercanos: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(knn.pred,Direction<span class="fl">.2005</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

        Direction.2005
knn.pred Down Up
    Down   48 55
    Up     63 86
                                          
               Accuracy : 0.5317          
                 95% CI : (0.4681, 0.5946)
    No Information Rate : 0.5595          
    P-Value [Acc &gt; NIR] : 0.8294          
                                          
                  Kappa : 0.0427          
                                          
 Mcnemar's Test P-Value : 0.5193          
                                          
            Sensitivity : 0.4324          
            Specificity : 0.6099          
         Pos Pred Value : 0.4660          
         Neg Pred Value : 0.5772          
             Prevalence : 0.4405          
         Detection Rate : 0.1905          
   Detection Prevalence : 0.4087          
      Balanced Accuracy : 0.5212          
                                          
       'Positive' Class : Down            
                                          </code></pre>
</div>
</div>
</section>
<section id="ejercicio" class="slide level2">
<h2>Ejercicio</h2>
<p>Realizar <strong>KNN</strong> con el conjunto <code>Caravan</code> del paquete <code>ISLR</code>. El conjunto de datos corresponde a 85 predictores que miden características demográficas para 5822 personas, en donde la variable respuesta es <code>Purchase</code> que indica si la persona adquirió un póliza de seguros. Realice el ejercicio con y sin estandarización de variables.</p>
</section></section>
<section>
<section id="árbol-de-decisión" class="title-slide slide level1 center">
<h1>Árbol de decisión</h1>
<p>Los árboles de decisión son una metodología que estratifica o segmenta el espacio de los predictores en distintas regiones, en donde se utiliza una serie de reglas de división para segmentar los espacios.</p>
<p>En general, esta metodología no es lo suficientemente competitiva en contraste con otras técnicas supervisadas (en términos de su precisión).</p>
<p>Los árboles de decisión pueden ser aplicados a problemas de regresión y clasificación, en lo que sigue sólo nos concentramos en esta metodología para problemas de clasificación.</p>
</section>
<section id="definición" class="slide level2">
<h2>Definición</h2>
<p>En un árbol de decisión para problemas de clasificación se predice que cada observación pertenece a la clase más frecuente entre las observaciones de entrenamiento en la región a la que pertenece.</p>
<p>Utilizamos la <strong>tasa de error de clasificación</strong> para separar los espacios a lo largo del árbol de decisión. Debido a que se planea asignar una observación en una región particular a la <em>clase más frecuente</em> en el conjunto de entrenamiento, este error se define como:</p>
<p><span class="math display">\[
E=1-\max_{k}(\hat{p}_{mk})
\]</span></p>
<p>en donde <span class="math inline">\(\hat{p}_{mk}\)</span> representa la proporción de observaciones de entrenamiento en la región <span class="math inline">\(m-\)</span>ésima que son de la clase <span class="math inline">\(k-\)</span>ésima.</p>
</section>
<section id="diagrama-de-ejemplo" class="slide level2">
<h2>Diagrama de ejemplo</h2>

<img data-src="images/week8/tree1.png" class="r-stretch quarto-figure-center"></section>
<section id="definición-continuación" class="slide level2">
<h2>Definición: continuación</h2>
<p>En general, usar sólo la tasa de error de clasifición no es lo suficientemente sensible para esta metodología, y se opta por dos medidas alternativas: índice de Gini y entropía cruzada.</p>
<p>El <strong>índice de Gini</strong> está definido como:</p>
<p><span class="math display">\[
G=\sum_{k=1}^{K} \hat{p}_{mk}(1-\hat{p}_{mk})
\]</span></p>
<p>que es una medida de la varianza total a lo largo de las <span class="math inline">\(K\)</span> clases. Es claro ver que este índice toma valores pequeños si todos los <span class="math inline">\(\hat{p}_{mk}\)</span> son cercanos a cero.</p>
</section>
<section id="definición-continuación-1" class="slide level2">
<h2>Definición: continuación</h2>
<p>Una alternativa al índice anterior es la <strong>entropía cruzada</strong>, dada por:</p>
<p><span class="math display">\[
D=-\sum_{k=1}^{K} \hat{p}_{mk}\log \hat{p}_{mk}.
\]</span></p>
<p>Debido a que <span class="math inline">\(0 \leq \hat{p}_{mk}\leq 1\)</span>, sigue que <span class="math inline">\(0\leq -\hat{p}_{mk}\log\hat{p}_{mk}\)</span>. Se puede mostrar que la entropía cruzada tomará valores cercanos a cero si todos los <span class="math inline">\(\hat{p}_{mk}\)</span> están cercano a cero o a uno. Por lo que ambos índices tomaran valores pequeños si la <span class="math inline">\(m-\)</span>ésimo <em>nodo</em> es <em>puro</em>.</p>
</section>
<section id="ejemplo" class="slide level2">
<h2>Ejemplo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="fu">library</span>(tree)</span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="fu">attach</span>(Carseats)</span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="fu">require</span>(ISLR)</span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="fu">head</span>(Carseats)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sales CompPrice Income Advertising Population Price ShelveLoc Age Education
1  9.50       138     73          11        276   120       Bad  42        17
2 11.22       111     48          16        260    83      Good  65        10
3 10.06       113     35          10        269    80    Medium  59        12
4  7.40       117    100           4        466    97    Medium  55        14
5  4.15       141     64           3        340   128       Bad  38        13
6 10.81       124    113          13        501    72       Bad  78        16
  Urban  US
1   Yes Yes
2   Yes Yes
3   Yes Yes
4   Yes Yes
5   Yes  No
6    No Yes</code></pre>
</div>
</div>
</section>
<section id="ejemplo-continuación" class="slide level2">
<h2>Ejemplo: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>High<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">ifelse</span>(Sales<span class="sc">&lt;=</span><span class="dv">8</span>,<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb90-2"><a href="#cb90-2"></a>Carseats<span class="ot">=</span><span class="fu">data.frame</span>(Carseats,High)</span>
<span id="cb90-3"><a href="#cb90-3"></a>Carseats_tree<span class="ot">=</span><span class="fu">tree</span>(High<span class="sc">~</span> . <span class="sc">-</span>Sales, <span class="at">data=</span>Carseats)</span>
<span id="cb90-4"><a href="#cb90-4"></a><span class="fu">summary</span>(Carseats_tree)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Classification tree:
tree(formula = High ~ . - Sales, data = Carseats)
Variables actually used in tree construction:
[1] "ShelveLoc"   "Price"       "Income"      "CompPrice"   "Population" 
[6] "Advertising" "Age"         "US"         
Number of terminal nodes:  27 
Residual mean deviance:  0.4575 = 170.7 / 373 
Misclassification error rate: 0.09 = 36 / 400 </code></pre>
</div>
</div>
</section>
<section id="ejemplo-continuación-1" class="slide level2">
<h2>Ejemplo: continuación</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="fu">plot</span>(Carseats_tree)</span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="fu">text</span>(Carseats_tree, <span class="at">pretty=</span><span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lec_week8_files/figure-revealjs/unnamed-chunk-50-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="ejemplo-continuación-2" class="slide level2">
<h2>Ejemplo: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="co">#Alternativa</span></span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="fu">library</span>(rpart)</span>
<span id="cb93-3"><a href="#cb93-3"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb93-4"><a href="#cb93-4"></a>Carseats_tree2<span class="ot">&lt;-</span><span class="fu">rpart</span>(<span class="at">formula=</span>High<span class="sc">~</span> . <span class="sc">-</span>Sales, <span class="at">data=</span>Carseats)</span>
<span id="cb93-5"><a href="#cb93-5"></a><span class="fu">summary</span>(Carseats_tree2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = High ~ . - Sales, data = Carseats)
  n= 400 

          CP nsplit rel error    xerror       xstd
1 0.28658537      0 1.0000000 1.0000000 0.05997967
2 0.10975610      1 0.7134146 0.7134146 0.05547692
3 0.04573171      2 0.6036585 0.6463415 0.05382112
4 0.03658537      4 0.5121951 0.6402439 0.05365767
5 0.02743902      5 0.4756098 0.6158537 0.05298128
6 0.02439024      7 0.4207317 0.6158537 0.05298128
7 0.01219512      8 0.3963415 0.6158537 0.05298128
8 0.01000000     10 0.3719512 0.6219512 0.05315381

Variable importance
      Price   ShelveLoc         Age Advertising   CompPrice      Income 
         34          25          11          11           9           5 
 Population   Education 
          3           1 

Node number 1: 400 observations,    complexity param=0.2865854
  predicted class=No   expected loss=0.41  P(node) =1
    class counts:   236   164
   probabilities: 0.590 0.410 
  left son=2 (315 obs) right son=3 (85 obs)
  Primary splits:
      ShelveLoc   splits as  LRL,       improve=28.991900, (0 missing)
      Price       &lt; 92.5  to the right, improve=19.463880, (0 missing)
      Advertising &lt; 6.5   to the left,  improve=17.277980, (0 missing)
      Age         &lt; 61.5  to the right, improve= 9.264442, (0 missing)
      Income      &lt; 60.5  to the left,  improve= 7.249032, (0 missing)

Node number 2: 315 observations,    complexity param=0.1097561
  predicted class=No   expected loss=0.3111111  P(node) =0.7875
    class counts:   217    98
   probabilities: 0.689 0.311 
  left son=4 (269 obs) right son=5 (46 obs)
  Primary splits:
      Price       &lt; 92.5  to the right, improve=15.930580, (0 missing)
      Advertising &lt; 7.5   to the left,  improve=11.432570, (0 missing)
      ShelveLoc   splits as  L-R,       improve= 7.543912, (0 missing)
      Age         &lt; 50.5  to the right, improve= 6.369905, (0 missing)
      Income      &lt; 60.5  to the left,  improve= 5.984509, (0 missing)
  Surrogate splits:
      CompPrice &lt; 95.5  to the right, agree=0.873, adj=0.13, (0 split)

Node number 3: 85 observations,    complexity param=0.03658537
  predicted class=Yes  expected loss=0.2235294  P(node) =0.2125
    class counts:    19    66
   probabilities: 0.224 0.776 
  left son=6 (12 obs) right son=7 (73 obs)
  Primary splits:
      Price       &lt; 142.5 to the right, improve=7.745608, (0 missing)
      US          splits as  LR,        improve=5.112440, (0 missing)
      Income      &lt; 35    to the left,  improve=4.529433, (0 missing)
      Advertising &lt; 6     to the left,  improve=3.739996, (0 missing)
      Education   &lt; 15.5  to the left,  improve=2.565856, (0 missing)
  Surrogate splits:
      CompPrice &lt; 154.5 to the right, agree=0.882, adj=0.167, (0 split)

Node number 4: 269 observations,    complexity param=0.04573171
  predicted class=No   expected loss=0.2453532  P(node) =0.6725
    class counts:   203    66
   probabilities: 0.755 0.245 
  left son=8 (224 obs) right son=9 (45 obs)
  Primary splits:
      Advertising &lt; 13.5  to the left,  improve=10.400090, (0 missing)
      Age         &lt; 49.5  to the right, improve= 8.083998, (0 missing)
      ShelveLoc   splits as  L-R,       improve= 7.023150, (0 missing)
      CompPrice   &lt; 124.5 to the left,  improve= 6.749986, (0 missing)
      Price       &lt; 126.5 to the right, improve= 5.646063, (0 missing)

Node number 5: 46 observations,    complexity param=0.02439024
  predicted class=Yes  expected loss=0.3043478  P(node) =0.115
    class counts:    14    32
   probabilities: 0.304 0.696 
  left son=10 (10 obs) right son=11 (36 obs)
  Primary splits:
      Income      &lt; 57    to the left,  improve=4.000483, (0 missing)
      ShelveLoc   splits as  L-R,       improve=3.189762, (0 missing)
      Advertising &lt; 9.5   to the left,  improve=1.388592, (0 missing)
      Price       &lt; 80.5  to the right, improve=1.388592, (0 missing)
      Age         &lt; 64.5  to the right, improve=1.172885, (0 missing)

Node number 6: 12 observations
  predicted class=No   expected loss=0.25  P(node) =0.03
    class counts:     9     3
   probabilities: 0.750 0.250 

Node number 7: 73 observations
  predicted class=Yes  expected loss=0.1369863  P(node) =0.1825
    class counts:    10    63
   probabilities: 0.137 0.863 

Node number 8: 224 observations,    complexity param=0.02743902
  predicted class=No   expected loss=0.1830357  P(node) =0.56
    class counts:   183    41
   probabilities: 0.817 0.183 
  left son=16 (96 obs) right son=17 (128 obs)
  Primary splits:
      CompPrice   &lt; 124.5 to the left,  improve=4.881696, (0 missing)
      Age         &lt; 49.5  to the right, improve=3.960418, (0 missing)
      ShelveLoc   splits as  L-R,       improve=3.654633, (0 missing)
      Price       &lt; 126.5 to the right, improve=3.234428, (0 missing)
      Advertising &lt; 6.5   to the left,  improve=2.371276, (0 missing)
  Surrogate splits:
      Price      &lt; 115.5 to the left,  agree=0.741, adj=0.396, (0 split)
      Age        &lt; 50.5  to the right, agree=0.634, adj=0.146, (0 split)
      Population &lt; 405   to the right, agree=0.629, adj=0.135, (0 split)
      Education  &lt; 11.5  to the left,  agree=0.585, adj=0.031, (0 split)
      Income     &lt; 22.5  to the left,  agree=0.580, adj=0.021, (0 split)

Node number 9: 45 observations,    complexity param=0.04573171
  predicted class=Yes  expected loss=0.4444444  P(node) =0.1125
    class counts:    20    25
   probabilities: 0.444 0.556 
  left son=18 (20 obs) right son=19 (25 obs)
  Primary splits:
      Age       &lt; 54.5  to the right, improve=6.722222, (0 missing)
      CompPrice &lt; 121.5 to the left,  improve=4.629630, (0 missing)
      ShelveLoc splits as  L-R,       improve=3.250794, (0 missing)
      Income    &lt; 99.5  to the left,  improve=3.050794, (0 missing)
      Price     &lt; 127   to the right, improve=2.933429, (0 missing)
  Surrogate splits:
      Population  &lt; 363.5 to the left,  agree=0.667, adj=0.25, (0 split)
      Income      &lt; 39    to the left,  agree=0.644, adj=0.20, (0 split)
      Advertising &lt; 17.5  to the left,  agree=0.644, adj=0.20, (0 split)
      CompPrice   &lt; 106.5 to the left,  agree=0.622, adj=0.15, (0 split)
      Price       &lt; 135.5 to the right, agree=0.622, adj=0.15, (0 split)

Node number 10: 10 observations
  predicted class=No   expected loss=0.3  P(node) =0.025
    class counts:     7     3
   probabilities: 0.700 0.300 

Node number 11: 36 observations
  predicted class=Yes  expected loss=0.1944444  P(node) =0.09
    class counts:     7    29
   probabilities: 0.194 0.806 

Node number 16: 96 observations
  predicted class=No   expected loss=0.0625  P(node) =0.24
    class counts:    90     6
   probabilities: 0.938 0.062 

Node number 17: 128 observations,    complexity param=0.02743902
  predicted class=No   expected loss=0.2734375  P(node) =0.32
    class counts:    93    35
   probabilities: 0.727 0.273 
  left son=34 (107 obs) right son=35 (21 obs)
  Primary splits:
      Price     &lt; 109.5 to the right, improve=9.764582, (0 missing)
      ShelveLoc splits as  L-R,       improve=6.320022, (0 missing)
      Age       &lt; 49.5  to the right, improve=2.575061, (0 missing)
      Income    &lt; 108.5 to the right, improve=1.799546, (0 missing)
      CompPrice &lt; 143.5 to the left,  improve=1.741982, (0 missing)

Node number 18: 20 observations
  predicted class=No   expected loss=0.25  P(node) =0.05
    class counts:    15     5
   probabilities: 0.750 0.250 

Node number 19: 25 observations
  predicted class=Yes  expected loss=0.2  P(node) =0.0625
    class counts:     5    20
   probabilities: 0.200 0.800 

Node number 34: 107 observations,    complexity param=0.01219512
  predicted class=No   expected loss=0.1869159  P(node) =0.2675
    class counts:    87    20
   probabilities: 0.813 0.187 
  left son=68 (65 obs) right son=69 (42 obs)
  Primary splits:
      Price     &lt; 126.5 to the right, improve=2.9643900, (0 missing)
      CompPrice &lt; 147.5 to the left,  improve=2.2337090, (0 missing)
      ShelveLoc splits as  L-R,       improve=2.2125310, (0 missing)
      Age       &lt; 49.5  to the right, improve=2.1458210, (0 missing)
      Income    &lt; 60.5  to the left,  improve=0.8025853, (0 missing)
  Surrogate splits:
      CompPrice   &lt; 129.5 to the right, agree=0.664, adj=0.143, (0 split)
      Advertising &lt; 3.5   to the right, agree=0.664, adj=0.143, (0 split)
      Population  &lt; 53.5  to the right, agree=0.645, adj=0.095, (0 split)
      Age         &lt; 77.5  to the left,  agree=0.636, adj=0.071, (0 split)
      US          splits as  RL,        agree=0.626, adj=0.048, (0 split)

Node number 35: 21 observations
  predicted class=Yes  expected loss=0.2857143  P(node) =0.0525
    class counts:     6    15
   probabilities: 0.286 0.714 

Node number 68: 65 observations
  predicted class=No   expected loss=0.09230769  P(node) =0.1625
    class counts:    59     6
   probabilities: 0.908 0.092 

Node number 69: 42 observations,    complexity param=0.01219512
  predicted class=No   expected loss=0.3333333  P(node) =0.105
    class counts:    28    14
   probabilities: 0.667 0.333 
  left son=138 (22 obs) right son=139 (20 obs)
  Primary splits:
      Age         &lt; 49.5  to the right, improve=5.4303030, (0 missing)
      CompPrice   &lt; 137.5 to the left,  improve=2.1000000, (0 missing)
      Advertising &lt; 5.5   to the left,  improve=1.8666670, (0 missing)
      ShelveLoc   splits as  L-R,       improve=1.4291670, (0 missing)
      Population  &lt; 382   to the right, improve=0.8578431, (0 missing)
  Surrogate splits:
      Income      &lt; 46.5  to the left,  agree=0.595, adj=0.15, (0 split)
      Education   &lt; 12.5  to the left,  agree=0.595, adj=0.15, (0 split)
      CompPrice   &lt; 131.5 to the right, agree=0.571, adj=0.10, (0 split)
      Advertising &lt; 5.5   to the left,  agree=0.571, adj=0.10, (0 split)
      Population  &lt; 221.5 to the left,  agree=0.571, adj=0.10, (0 split)

Node number 138: 22 observations
  predicted class=No   expected loss=0.09090909  P(node) =0.055
    class counts:    20     2
   probabilities: 0.909 0.091 

Node number 139: 20 observations
  predicted class=Yes  expected loss=0.4  P(node) =0.05
    class counts:     8    12
   probabilities: 0.400 0.600 </code></pre>
</div>
</div>
</section>
<section id="ejemplo-continuación-3" class="slide level2">
<h2>Ejemplo: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>tree_plot<span class="ot">&lt;-</span><span class="fu">rpart.plot</span>(Carseats_tree2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="lec_week8_files/figure-revealjs/unnamed-chunk-54-1.png" width="960" class="r-stretch"></section>
<section id="ejemplo-continuación-4" class="slide level2">
<h2>Ejemplo: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb96-2"><a href="#cb96-2"></a>train<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Carseats), <span class="dv">200</span>)</span>
<span id="cb96-3"><a href="#cb96-3"></a>Carseats_test<span class="ot">=</span>Carseats[<span class="sc">-</span>train,]</span>
<span id="cb96-4"><a href="#cb96-4"></a>High_test<span class="ot">=</span>High[<span class="sc">-</span>train]</span>
<span id="cb96-5"><a href="#cb96-5"></a>Carseats_tree<span class="ot">=</span><span class="fu">tree</span>(High<span class="sc">~</span> .<span class="sc">-</span>Sales ,Carseats ,<span class="at">subset =</span> train)</span>
<span id="cb96-6"><a href="#cb96-6"></a>tree_pred<span class="ot">=</span><span class="fu">predict</span>(Carseats_tree ,Carseats_test , <span class="at">type =</span><span class="st">"class"</span>)</span>
<span id="cb96-7"><a href="#cb96-7"></a><span class="fu">table</span>(tree_pred,High_test)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         High_test
tree_pred  No Yes
      No  104  33
      Yes  13  50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>(<span class="dv">104</span><span class="sc">+</span><span class="dv">50</span>)<span class="sc">/</span><span class="dv">200</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.77</code></pre>
</div>
</div>
</section>
<section id="ejemplo-continuación-5" class="slide level2">
<h2>Ejemplo: continuación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(tree_pred,High_test))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

         High_test
tree_pred  No Yes
      No  104  33
      Yes  13  50
                                          
               Accuracy : 0.77            
                 95% CI : (0.7054, 0.8264)
    No Information Rate : 0.585           
    P-Value [Acc &gt; NIR] : 2.938e-08       
                                          
                  Kappa : 0.5091          
                                          
 Mcnemar's Test P-Value : 0.005088        
                                          
            Sensitivity : 0.8889          
            Specificity : 0.6024          
         Pos Pred Value : 0.7591          
         Neg Pred Value : 0.7937          
             Prevalence : 0.5850          
         Detection Rate : 0.5200          
   Detection Prevalence : 0.6850          
      Balanced Accuracy : 0.7456          
                                          
       'Positive' Class : No              
                                          </code></pre>
</div>
</div>
</section></section>
<section id="qué-veremos-la-próxima-semana" class="title-slide slide level1 center">
<h1>¿Qué veremos la próxima semana?</h1>
<ul>
<li class="fragment">Métodos supervisados: continuación
<ul>
<li class="fragment">SVM</li>
</ul></li>
<li class="fragment">Métodos no supervisados: introducción</li>
</ul>
</section>

<section id="que-deben-preparar-para-la-próxima-semana" class="title-slide slide level1 center">
<h1>¿Que deben preparar para la próxima semana?</h1>
<ul>
<li class="fragment">Capítulo 8 y 9 , Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems. Géron, Aurélien.</li>
<li class="fragment">Capítulo 9, An Introduction to Statistical Learning with Applications in R.</li>
</ul>


<img src="images/logo_usm.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p>IND 163 - Semana 8</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiada");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>